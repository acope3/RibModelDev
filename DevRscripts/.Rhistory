test<- cbind(chain$phi.pred.Mat[[1001]])
hist(test, nclass=50)
hist(log(test), nclass=50)
suppressMessages(library(cubfits, quietly = TRUE))
load("~/CodonUsageBias/R_roc/debug.RData")
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
names(results$chains$b.Mat[[1]]_
names(results$chains$b.Mat[[1]])
bmat.names <- names(results$chains$b.Mat[[1]])
bmat.names <- names(results$chains[[1]]$b.Mat[[1]])
load("~/CodonUsageBias/R_roc/debug.RData")
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
suppressMessages(library(cubfits, quietly = TRUE))
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
source('~/CodonUsageBias/R_roc/config.r', echo=TRUE)
results <- list()
length(results) <- config$n.chains
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
plotPTraces(results$chains$p.Mat)
dgamma(0.5, 5, 4) - dgamma(0, 5, 4)
dgamma(0, 5, 4) - dgamma(0.5, 5, 4)
dgamma(0.5, 5, 4)/dgamma(0, 5, 4)
dgamma(0, 5, 4)
dgamma(0.5, 5, 4)/dgamma(0.1, 5, 4)
suppressMessages(library(cubfits, quietly = TRUE))
load("~/CodonUsageBias/R_roc/debug.RData")
source('~/CodonUsageBias/R_roc/config.r', echo=TRUE)
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
load("~/CodonUsageBias/R_roc/debug.RData")
suppressMessages(library(cubfits, quietly = TRUE))
results <- cubsinglechain(cubmethods, frac1=config$frac1, frac2=config$frac2,
reset.qr=config$reset.qr, seed=seeds[1], teston="sphi",
min=config$min.samples, max=config$max.samples, conv.thin=config$conv.thin, eps=config$eps,
reu13.df.obs=data$reu13.df, y=data$y, n=data$n, phi.pred.Init=init.phi[[1]],
nIter=iterations, p.Init=p.init[[1]], iterThin=config$chain.thin,
model="roc", adaptive="simple", .CF.CT=.CF.CT, .CF.CONF=.CF.CONF)
plotPTraces(results$chains$p.Mat)
source('~/CodonUsageBias/localNSE/NSEexchange/R/load.genome.R', echo=TRUE)
d <- 10000*runif(1000)
P <- (1+(1000/d))^-8
plot(d,P, type="l", xlab="Distance(km)", ylab="P(Alien)")
d <- sort(10000*runif(1000))
P <- (1+(1000/d))^-8
plot(d,P, type="l", xlab="Distance(km)", ylab="P(Alien)")
d <- sort(100000*runif(1000))
P <- (1+(1000/d))^-8
plot(d,P, type="l", xlab="Distance(km)", ylab="P(Alien)")
plot(d,P, type="l", xlab="Distance(km)", ylab="P(Alien)", main="Probability that a species is considered Alien")
d <- sort(50000*runif(1000))
P <- (1+(1000/d))^-8
plot(d,P, type="l", xlab="Distance(km)", ylab="P(Alien)", main="Probability that a species is considered Alien")
plot(d,P, type="l", xlab="Distance(km)", ylab="P(Alien)", main="Probability that a species is considered Alien", lwd=2)
plot(d,P, type="l", xlab="Distance(km)", ylab="P(Alien)", main="Probability that a species is considered Alien", lwd=3)
B <- sort(50000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*10)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
B <- sort(50000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*30)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
B <- sort(5000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*30)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
B <- sort(5000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*1)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
B <- sort(5000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*15)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
B <- sort(5000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*14)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
B <- sort(5000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*10)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
B <- sort(3000*runif(1000))
P <- (1-exp(-0.002*B))*exp(-0.02*10)
plot(B,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
plot(B*1000,P, type="l", xlab="Ballast(l)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
plot(B,P, type="l", xlab="Ballast(m^3)", ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
plot(B,P, type="l", xlab=expression("Ballast(m"^3")"), ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
plot(B,P, type="l", xlab=expression("Ballast(m"3")"), ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
expression("Ballast(m"3")")
expression("Ballast(m"[3]")")
expression("Ballast(m"~3~")")
plot(B,P, type="l", xlab=expression("Ballast(m"~3~")"), ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
plot(B,P, type="l", xlab=expression("Ballast("~m^{3}~")"), ylab="P(Intro)", main="Probability that an Alien is introduced", lwd=3)
sd(Tij)
Tij <- sort(10*runif(1000))
sd(Tij)
Sij <- sort(40*runif(1000))
sd(Sij)
Tij <- sort(40*runif(1000))
Sij <- sort(10*runif(1000))
P <- 0.00015*exp( -0.5*( (Tij/10)^2 + (Sij/3) ) )
contour(x = Tij, y = Sij, z = P)
P <- matrix(0, nrow = 1000, ncol = 1000)
for(i in 1:1000)
{
for(j in 1:1000)
{
P[i,j] <- 0.00015*exp( -0.5*( (Tij[i]/10)^2 + (Sij[j]/3) ) )
}
}
contour(x = Tij, y = Sij, z = P)
filled.contour(x = Tij, y = Sij, z = P)
Tij <- sort(10*runif(1000))
Sij <- sort(10*runif(1000))
P <- matrix(0, nrow = 1000, ncol = 1000)
for(i in 1:1000)
{
for(j in 1:1000)
{
P[i,j] <- 0.00015*exp( -0.5*( (Tij[i]/2)^2 + (Sij[j]/10) ) )
}
}
filled.contour(x = Tij, y = Sij, z = P)
Tij <- sort(10*runif(1000))
Sij <- sort(100*runif(1000))
P <- matrix(0, nrow = 1000, ncol = 1000)
for(i in 1:1000)
{
for(j in 1:1000)
{
P[i,j] <- 0.00015*exp( -0.5*( (Tij[i]/2)^2 + (Sij[j]/10) ) )
}
}
filled.contour(x = Tij, y = Sij, z = P)
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(DeltaT[ij]))
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]))
Tij <- sort(10*runif(1000))
Sij <- sort(10*runif(1000))
P <- matrix(0, nrow = 1000, ncol = 1000)
for(i in 1:1000)
{
for(j in 1:1000)
{
P[i,j] <- 0.00015*exp( -0.5*( (Tij[i]/2)^2 + (Sij[j]/10) ) )
}
}
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]))
Tij <- sort(10*runif(1000))
Sij <- sort(10*runif(1000))
P <- matrix(0, nrow = 1000, ncol = 1000)
for(i in 1:1000)
{
for(j in 1:1000)
{
P[i,j] <- 0.00015*exp( -0.5*( (Tij[i]/2)^2 + (Sij[j]/10)^2 ) )
}
}
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]))
Tij <- sort(3*runif(1000))
Sij <- sort(10*runif(1000))
P <- matrix(0, nrow = 1000, ncol = 1000)
for(i in 1:1000)
{
for(j in 1:1000)
{
P[i,j] <- 0.00015*exp( -0.5*( (Tij[i]/2)^2 + (Sij[j]/10)^2 ) )
}
}
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]))
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = heat.colors)
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = rev(heat.colors))
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = rev(heat.colors(10)))
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = heat.colors)
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = rainbow)
?rainbow
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = topo.colors)
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = terrain.colors)
filled.contour(x = Tij, y = Sij, z = P, xlab=expression(Delta~T[ij]), ylab=expression(Delta~S[ij]), color.palette = terrain.colors,
main="Probability of establishment of an Alien")
source('~/Dropbox/Invasion Risks Via Shipping Networks/R/ODE_RandomNetworks.R', echo=TRUE)
source('~/Dropbox/Invasion Risks Via Shipping Networks/R/ODE_RandomNetworks.R', echo=TRUE)
install.packages("deSolve")
install.packages("deSolve")
dnorm(-10000)
dnorm(-10000, log=T)
-rexp(1)
cubfits:::my.drawSPhiPrior
log(1:10)
exp(0.3)
exp(0:3)
exp(0:2.5)
exp(2.3)
exp(2.5)
exp(0:(2.5))
0:(2.5)
log(0.5)
phi.DrawScale <- .CF.CONF$phi.DrawScale
curr <- -100
prop <- -200
phi.curr <- 1
phi.prop <- 1.5
(prop - curr) - (phi.curr - phi.prop)
exp((prop - curr) - (phi.curr - phi.prop))
(prop - curr) - (phi.curr - phi.prop)
(exp(prop)/exp(curr))/(exp(phi.curr)/exp(phi.prop))
(prop - phi.prop) - (curr - phi.curr)
(prop - phi.curr) - (curr - phi.prop)
exp((prop - phi.curr) - (curr - phi.prop))
rmultinom(1, 3, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rmultinom(1, 1, c(0.1,0.3, 0.6))
rdirichlet <- function(n, alpha){
x <- matrix(rgamma(n * length(alpha), alpha, 1), nrow = n, byrow = TRUE)
x / rowSums(x)
} # End of rdirichlet().
rdirichlet(1, c(0,1,0,0,0))
rgamma(n = 1,shape = 0, rate = 1)
?gamma
rdirichlet(1, c(1,2,1,1,1))
rdirichlet(1, c(1,2,1,1,1))
rdirichlet(1, c(1,2,1,1,1))
rdirichlet(1, c(1,2,1,1,1))
library(ribModel)
library(Rcpp)
SequenceSummary <- Module("SequenceSummary_mod")
SequenceSummary$SequenceSummary
library(ribModel)
mod <- new(SequenceSummary)
mod <- new(SequenceSummary_mod)
mod <- Module("SequenceSummary_mod")
new (mod)
mod <- Module("SequenceSummary_mod")
show(moe)
show(mod)
?Module
mod <- Module("SequenceSummary_mod", PACKAGE = "ribModel")
show(mod)
mod <- new(mod)
mod <- new(mod, "ACGTTTGCA")
mod <- Module("SequenceSummary_mod", PACKAGE = "ribModel")
show(mod)
library(ribModel)
seqsum <- SequenceSummary_mod$SequenceSummary
environment()
seqsum <- Module("SequenceSummary_mod")
library(Rcpp)
seqsum <- Module("SequenceSummary_mod")
new(seqsum)
show(seqsum)
seqsum <- Module("SequenceSummary_mod", PACKAGE = "ribModel")
show(seqsum)
library(ribModel)
SequenceSummary
seqsum <- new(SequenceSummary, "ACGTATGGGCCT")
seqsum$getAAcount( "A")
seqsum$getCodonCount("ACG")
seqsum$getCodonCount("T")
seqsum$getAAcount("T")
seqsum <- new(SequenceSummary, "atggccgttcgttga")
library(ribMoel)
library(ribModel)
seqsum <- new(SequenceSummary, "atggccgttcgttga")
seqsum$getAAcount( 'A')
seqsum$getAAcount( 'M')
seqsum$getAAcount( 'a')
seqsum$getAAcount( 'm')
seqsum$getAAcount('s')
seqsum$getAAcount('z')
seqsum$clear( )
seqsum$processSequence( "CTTCTTCTTattattatt")
seqsum$getAAcount('L')
seqsum$getAAcount('I')
seqsum$getCodonCount( "ctt")
seqsum$getCodonCount( "att")
seqsum$getCodonCount( "ATT")
seqsum$getCodonCount( "CTT")
seqsum2 <- seqsum
seqsum2$getAAcount( "I")
seqsum2$clear()
seqsum2$getAAcount( "I")
seqsum$getAAcount( "I" )
seqsum$processSequence( "CTTCTTCTTattattatt")
seqsum2 <- new(SequenceSummary, seqsum)
library(ribModel)
aminoAcids
aminoAcids
aminoAcids()
CodonToAA(codon = "ATG")
CodonToAA(codon = "ATG"
)
source('~/CodonUsageBias/RibosomeModel/RibModelFramework/ribModel/R/plotParameterObject.R', echo=TRUE)
library(ribModel)
library(ribModel)
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
library(ribModel)
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
new(MCMCAlgorithm)
library(ribModel)
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
library(ribModel)
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
adaptiveWidth <- 100
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
library(ribModel)
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
library(ribModel)
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
library(ribModel)
source('~/CodonUsageBias/RibosomeModel/RibModelFramework/ribModel/R/mcmcObject.R', echo=TRUE)
# initialize MCMC object
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
source('~/CodonUsageBias/RibosomeModel/RibModelFramework/ribModel/R/mcmcObject.R', echo=TRUE)
# initialize MCMC object
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
library(ribModel)
# initialize MCMC object
samples <- 200
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
source('~/CodonUsageBias/RibosomeModel/RibModelFramework/ribModel/R/parameterObject.R', echo=TRUE)
mixture.definition = "allUnique"
split.serine = TRUE
parameter <- new(ROCParameter, 1, 1, c(1,1,1,1), split.serine, mixture.definition)
library(ribModel)
library(ribModel)
parameter <- new(ROCParameter, 1, 1, c(1,1,1,1), split.serine, mixture.definition)
library(ribModel)
x <- rnorm(1000)
TestACF(x, 1000, 1, 30, F, T)
?system
setwd("~/CodonUsageBias/RibosomeModel/development/DevRscripts")
rm(list=ls())
library(ribModel)
seeds <- read.table(file = "seed.txt")[,1]
task.id <- 1 #as.numeric(Sys.getenv("SGE_TASK_ID"))
set.seed(446141)
with.phi <- TRUE
if (with.phi) {
genome <- initializeGenomeObject(file = "../data/twoMixtures/simulatedAllUniqueR.fasta", expression.file = "../data/twoMixtures/simulatedAllUniqueR_phi_withPhiSet.csv")
} else {
genome <- initializeGenomeObject(file = "../data/twoMixtures/simulatedAllUniqueR.fasta")
}
sphi_init <- c(1,1)
numMixtures <- 2
mixDef <- "allUnique"
geneAssignment <- sample(c(1,2), size = length(genome), replace = TRUE, prob = c(0.3, 0.7)) #c(rep(1,500), rep(2,500))
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, split.serine = TRUE, mixture.definition = mixDef)
#parameter <- initializeParameterObject(restart.file = "5001_simulated_allUnique.rst")
samples <- 100
thining <- 10
adaptiveWidth <- 10
divergence.iteration <- 0
mcmc <- initializeMCMCObject(samples, thining, adaptive.width=adaptiveWidth, est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
model <- initializeModelObject(parameter, "ROC", with.phi = with.phi)
start <- Sys.time()
system.time(runMCMC(mcmc, genome, model, 4, divergence.iteration))
end <- Sys.time()
end - start
plot(mcmc)
rm(list=ls())
library(ribModel)
seeds <- read.table(file = "seed.txt")[,1]
task.id <- 1 #as.numeric(Sys.getenv("SGE_TASK_ID"))
set.seed(446141)
with.phi <- TRUE
if (with.phi) {
genome <- initializeGenomeObject(file = "../data/twoMixtures/simulatedAllUniqueR.fasta", expression.file = "../data/twoMixtures/simulatedAllUniqueR_phi_withPhiSet.csv")
} else {
genome <- initializeGenomeObject(file = "../data/twoMixtures/simulatedAllUniqueR.fasta")
}
sphi_init <- c(1,1)
numMixtures <- 2
mixDef <- "allUnique"
geneAssignment <- sample(c(1,2), size = length(genome), replace = TRUE, prob = c(0.3, 0.7)) #c(rep(1,500), rep(2,500))
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, split.serine = TRUE, mixture.definition = mixDef)
samples <- 100
thining <- 10
adaptiveWidth <- 10
divergence.iteration <- 0
mcmc <- initializeMCMCObject(samples, thining, adaptive.width=adaptiveWidth, est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
model <- initializeModelObject(parameter, "ROC", with.phi = with.phi)
start <- Sys.time()
system.time(runMCMC(mcmc, genome, model, 4, divergence.iteration))
end <- Sys.time()
end - start
plot(mcmc)
trace <- parameter$getTraceObject()
plot(trace, what = "MixtureProbability")
plot(trace, what = "Sphi")
plot(trace, what = "Mphi")
plot(trace, what = "Aphi")
plot(trace, what = "Sepsilon")
plot(trace, what = "ExpectedPhi")
mixtureAssignment <- unlist(lapply(1:length(genome),  function(geneIndex){parameter$getEstimatedMixtureAssignmentForGene(samples*0.1, geneIndex)}))
expressionValues <- unlist(lapply(1:length(genome), function(geneIndex){
expressionCategory <- parameter$getSynthesisRateCategoryForMixture(mixtureAssignment[geneIndex])
parameter$getSynthesisRatePosteriorMeanByMixtureElementForGene(samples*0.1, geneIndex, expressionCategory)
}))
expressionValues <- log10(expressionValues)
obs.phi <- log10(read.table("../data/twoMixtures/simulatedAllUniqueR_phi.csv", sep=",", header=T)[, 2])
plot(NULL, NULL, xlim=range(obs.phi) + c(-0.1, 0.1), ylim=range(expressionValues, na.rm = T) + c(-0.1, 0.1),
main = "Synthesis Rate", xlab = "True values", ylab = "Estimated values")
for(k in 1:numMixtures){
if(sum(mixtureAssignment == k) == 0) next
upper.panel.plot(obs.phi[mixtureAssignment == k], expressionValues[mixtureAssignment == k], col=ribModel:::.mixtureColors[k])
}
legend("topleft", legend = paste("Mixture Element", 1:numMixtures),
col = ribModel:::.mixtureColors[1:numMixtures], lty = rep(1, numMixtures), bty = "n")
rm(list=ls())
library(ribModel)
rm(list=ls())
library(ribModel)
#seeds <- read.table(file = "seed.txt")[,1]
#task.id <- as.numeric(Sys.getenv("SGE_TASK_ID"))
#set.seed(seeds[task.id])
set.seed(446141)
with.phi <- FALSE
if (with.phi) {
genome <- initializeGenomeObject(file = "../data/realGenomes/Skluyveri.fasta", expression.file = "../data/realGenomes/Skluyveri_phi.csv")
} else {
genome <- initializeGenomeObject(file = "../data/realGenomes/Skluyveri.fasta")
}
sphi_init <- c(1,1)
numMixtures <- 2
mixDef <- "allUnique"
geneAssignment <- c(rep(1,961), rep(2,457), rep(1, 3903))
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, split.serine = TRUE, mixture.definition = mixDef)
samples <- 100
thining <- 10
adaptiveWidth <- 10
divergence.iteration <- 0
mcmc <- initializeMCMCObject(samples, thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE, est.mix = FALSE)
model <- initializeModelObject(parameter, "ROC", with.phi = with.phi)
start <- Sys.time()
system.time(runMCMC(mcmc, genome, model, 4, divergence.iteration))
end <- Sys.time()
end - start
