plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons", ylab = "Estimated values")
upper.panel.plot(x = 1:61, y = alphaList, sd.y = 1.96*sqrt(alpha.ci))
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = 1.96*sqrt(alpha.ci))
axis(2)
axis(1, tck = 0.02, labels = codonList)
axis(1, tck = 0.02, labels = codonList, at=1:61)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61)
?axis
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = 1.96*sqrt(alpha.ci))
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = 1.96*sqrt(alpha.ci))
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.5)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = 1.96*sqrt(alpha.ci))
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.7)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = 1.96*sqrt(alpha.ci))
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
source('~/Desktop/RibModelFramework/R/plotParameterObject.R', echo=TRUE)
trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
alpha.ci <- matrix(0, ncol=2, nrow=61)
alpha.ci[i,]<-quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
alpha.ci <- matrix(0, ncol=2, nrow=61)
alpha.ci[i,]<-quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
cat <- 1
proposal <- FALSE
alphaList <- numeric (61)
lambdaPrimeList <- numeric (61)
waitingTimes <- numeric(61)
alpha.ci <- matrix(0, ncol=2, nrow=61)
lambdaPrime.ci <- numeric(61)
phiList <- numeric(genome$getGenomeSize())
ids <- numeric(genome$getGenomeSize())
codonList <- codons()
i <- 1
for (i in 1:61)
{
codon <- codonList[i]
alphaList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alpha.ci[i,]<-quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
lambdaPrimeList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 1)
alpha.ci[i] <- parameter$getCodonSpecificVariance(cat, samples*0.5, codon, 0, TRUE)
lambdaPrime.ci[i] <- parameter$getCodonSpecificVariance(cat, samples*0.5, codon, 1, TRUE)
waitingTimes[i] <- alphaList[i] * lambdaPrimeList[i]
}
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
source('~/Desktop/RibModelFramework/R/plotParameterObject.R', echo=TRUE)
alph
alpha.ci[,2]
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alphaList),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alpha.ci),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
alphaTrace
alpha.ci
quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
alpha.ci <- matrix(0, ncol=2, nrow=61)
alpha.ci[i,]
alphaTrace[(samples * 0.5):samples]
i <- 1
for (i in 1:61)
{
codon <- codonList[i]
alphaList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alpha.ci[i,] <- quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
lambdaPrimeList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 1)
alpha.ci[i] <- parameter$getCodonSpecificVariance(cat, samples*0.5, codon, 0, TRUE)
lambdaPrime.ci[i] <- parameter$getCodonSpecificVariance(cat, samples*0.5, codon, 1, TRUE)
waitingTimes[i] <- alphaList[i] * lambdaPrimeList[i]
}
alpha.ci
cat <- 1
proposal <- FALSE
alphaList <- numeric (61)
lambdaPrimeList <- numeric (61)
waitingTimes <- numeric(61)
alpha.ci <- matrix(0, ncol=2, nrow=61)
lambdaPrime.ci <- numeric(61)
phiList <- numeric(genome$getGenomeSize())
ids <- numeric(genome$getGenomeSize())
codonList <- codons()
i <- 1
codon <- codonList[i]
alphaList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alpha.ci[i,]
quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
alpha.ci[i,] <- quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
alpha.ci[i,]
cat <- 1
proposal <- FALSE
alphaList <- numeric (61)
lambdaPrimeList <- numeric (61)
waitingTimes <- numeric(61)
alpha.ci <- matrix(0, ncol=2, nrow=61)
lambdaPrime.ci <- numeric(61)
phiList <- numeric(genome$getGenomeSize())
ids <- numeric(genome$getGenomeSize())
codonList <- codons()
i <- 1
for (i in 1:61)
{
codon <- codonList[i]
alphaList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alpha.ci[i,] <- quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
lambdaPrimeList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 1)
lambdaPrime.ci[i] <- parameter$getCodonSpecificVariance(cat, samples*0.5, codon, 1, TRUE)
waitingTimes[i] <- alphaList[i] * lambdaPrimeList[i]
}
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alpha.ci),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
upper.panel.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
source('~/Desktop/RibModelFramework/R/plotParameterObject.R', echo=TRUE)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alpha.ci),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
confidenceInterval.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
source('~/Desktop/RibModelFramework/R/plotParameterObject.R', echo=TRUE)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alpha.ci),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
confidenceInterval.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
source('~/Desktop/RibModelFramework/R/plotParameterObject.R', echo=TRUE)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alpha.ci),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
confidenceInterval.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
source('~/Desktop/RibModelFramework/R/plotParameterObject.R', echo=TRUE)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alpha.ci),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
confidenceInterval.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
rm(list=ls())
library(ribModel)
with.phi <- FALSE
if (with.phi) {
genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR.fasta", expression.file = "../ribModel/data/simulatedAllUniqueR_phi.csv")
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedOneMix.fasta", expression.file = "../ribModel/data/simulatedOneMix_simphi.csv")
} else {
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR_unevenMixtures.fasta")
genome <- initializeGenomeObject(file = "../data/realGenomes/Skluyveri.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/genome_2000.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/Skluyveri.fasta")
#genome <- initializeGenomeObject(file = "../../../organisms/human/data/human_genome_cds_brain.fasta")
}
#initialize parameter object
sphi_init <- c(1,1,1)
numMixtures <- 3
mixDef <- "allUnique"
geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457), rep(1, 3403), rep(3, 500)) # S.kluyveri full genome
#geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457))
#geneAssignment <- rep(1,328) # human brain
#geneAssignment <- c(rep(1,200), rep(2,800))
geneAssignment <- sample(x = c(1,2), size = 806, replace = T) #c(rep(1,400), rep(2,406))
#geneAssignment <- sample(x = c(1,2), size = 806, replace = T) #c(rep(1,400), rep(2,406))
#geneAssignment <- rep(1,2000)
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, split.serine = TRUE, mixture.definition = mixDef)
#parameter <- initializeParameterObject(restart.file = "2000restartFile.rst")
phivals <- parameter$readPhiValues( "../ribModel/data/simulatedAllUniqueR_phi.csv")
#parameter$initializeSynthesisRateByRandom(phivals)
parameter$initMutationCategories(c("../ribModel/data/simulated_mutation0.csv", "../ribModel/data/simulated_mutation1.csv") , 2)
parameter$initSelectionCategories(c("../ribModel/data/simulated_selection0.csv", "../ribModel/data/simulated_selection1.csv") , 2)
# initialize MCMC object
samples <- 10
thining <- 10
adaptiveWidth <- 10
divergence.iteration <- 0
mcmc <- initializeMCMCObject(samples, thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
# get model object
model <- initializeModelObject(parameter, "ROC", with.phi = with.phi)
setRestartSettings(mcmc, "restartFile.rst", adaptiveWidth*200, TRUE)
#run mcmc on genome with parameter using model
start <- Sys.time()
system.time(
runMCMC(mcmc, genome, model, 4, divergence.iteration)
)
end <- Sys.time()
end - start
rm(list=ls())
library(ribModel)
with.phi <- FALSE
if (with.phi) {
genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR.fasta", expression.file = "../ribModel/data/simulatedAllUniqueR_phi.csv")
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedOneMix.fasta", expression.file = "../ribModel/data/simulatedOneMix_simphi.csv")
} else {
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR_unevenMixtures.fasta")
genome <- initializeGenomeObject(file = "../data/realGenomes/Skluyveri.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/genome_2000.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/Skluyveri.fasta")
#genome <- initializeGenomeObject(file = "../../../organisms/human/data/human_genome_cds_brain.fasta")
}
#initialize parameter object
sphi_init <- c(1,1,1)
numMixtures <- 3
mixDef <- "allUnique"
geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457), rep(1, 3403), rep(3, 500)) # S.kluyveri full genome
#geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457))
#geneAssignment <- rep(1,328) # human brain
#geneAssignment <- c(rep(1,200), rep(2,800))
#geneAssignment <- sample(x = c(1,2), size = 806, replace = T) #c(rep(1,400), rep(2,406))
#geneAssignment <- sample(x = c(1,2), size = 806, replace = T) #c(rep(1,400), rep(2,406))
#geneAssignment <- rep(1,2000)
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, split.serine = TRUE, mixture.definition = mixDef)
#parameter <- initializeParameterObject(restart.file = "2000restartFile.rst")
phivals <- parameter$readPhiValues( "../ribModel/data/simulatedAllUniqueR_phi.csv")
#parameter$initializeSynthesisRateByRandom(phivals)
parameter$initMutationCategories(c("../ribModel/data/simulated_mutation0.csv", "../ribModel/data/simulated_mutation1.csv") , 2)
parameter$initSelectionCategories(c("../ribModel/data/simulated_selection0.csv", "../ribModel/data/simulated_selection1.csv") , 2)
# initialize MCMC object
samples <- 10
thining <- 10
adaptiveWidth <- 10
divergence.iteration <- 0
mcmc <- initializeMCMCObject(samples, thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
# get model object
model <- initializeModelObject(parameter, "ROC", with.phi = with.phi)
setRestartSettings(mcmc, "restartFile.rst", adaptiveWidth*200, TRUE)
#run mcmc on genome with parameter using model
start <- Sys.time()
system.time(
runMCMC(mcmc, genome, model, 4, divergence.iteration)
)
end <- Sys.time()
end - start
rm(list=ls())
library(ribModel)
with.phi <- FALSE
if (with.phi) {
genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR.fasta", expression.file = "../ribModel/data/simulatedAllUniqueR_phi.csv")
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedOneMix.fasta", expression.file = "../ribModel/data/simulatedOneMix_simphi.csv")
} else {
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/simulatedAllUniqueR_unevenMixtures.fasta")
genome <- initializeGenomeObject(file = "../data/realGenomes/Skluyveri.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/genome_2000.fasta")
#genome <- initializeGenomeObject(file = "../ribModel/data/Skluyveri.fasta")
#genome <- initializeGenomeObject(file = "../../../organisms/human/data/human_genome_cds_brain.fasta")
}
#initialize parameter object
sphi_init <- c(1,1,1)
numMixtures <- 3
mixDef <- "allUnique"
geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457), rep(1, 3403), rep(3, 500)) # S.kluyveri full genome
#geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457))
#geneAssignment <- rep(1,328) # human brain
#geneAssignment <- c(rep(1,200), rep(2,800))
#geneAssignment <- sample(x = c(1,2), size = 806, replace = T) #c(rep(1,400), rep(2,406))
#geneAssignment <- sample(x = c(1,2), size = 806, replace = T) #c(rep(1,400), rep(2,406))
#geneAssignment <- rep(1,2000)
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, split.serine = TRUE, mixture.definition = mixDef)
# initialize MCMC object
samples <- 10
thining <- 10
adaptiveWidth <- 10
divergence.iteration <- 0
mcmc <- initializeMCMCObject(samples, thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
# get model object
model <- initializeModelObject(parameter, "ROC", with.phi = with.phi)
setRestartSettings(mcmc, "restartFile.rst", adaptiveWidth*200, TRUE)
#run mcmc on genome with parameter using model
start <- Sys.time()
system.time(
runMCMC(mcmc, genome, model, 4, divergence.iteration)
)
end <- Sys.time()
end - start
aminoAcids()
library(ribModel)
rm(list=ls())
#read genome
genome.file <- "../data/FONSE/genome_2000.fasta"
phi.file <- "../data/realGenomes/Scereviciae.phi.csv"
mut.file <- "../data/realGenomes/Scereviciae.mut.csv"
sel.file <- "../data/realGenomes/Scereviciae.sel.csv"
from.good.values <- FALSE
genome <- initializeGenomeObject(genome.file)
sphi_init <- 1
numMixtures <- 1
mixDef <- "allUnique"
#geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457), rep(1, 3903))
#geneAssignment <- c(rep(1,448), rep(1,513), rep(2,457))
#geneAssignment <- c(rep(1,448), rep(2,457))
#geneAssignment <- c(rep(1,500), rep(2,500))
geneAssignment <- rep(1,length(genome))
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, model="FONSE", split.serine = TRUE,
mixture.definition = mixDef)
#parameter <- initializeParameterObject(model="FONSE", restart.file="10restartFile.rst")
# initialize MCMC object
samples <- 10
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
# get model object
model <- initializeModelObject(parameter, "FONSE")
if(from.good.values) {
phi <- read.table(phi.file, header = T, sep = ",")
phi.values <- phi[,2]
parameter$initializeSynthesisRateByList(phi.values)
}
setRestartSettings(mcmc, "restartFile.rst", 10, TRUE)
#run mcmc on genome with parameter using model
system.time(
runMCMC(mcmc, genome, model, 16)
)
library(ribModel)
library(ribModel)
library(ribModel)
library(ribModel)
aminoAcids()
rm(list=ls())
library(ribModel)
#read genome
genome <- initializeGenomeObject(file = "../data/rfp/rfp.counts.by.codon.and.gene.GSE63789.wt.csv", FALSE)
#initialize parameter object
sphi_init <- 2
numMixtures <- 1
mixDef <- "allUnique"
geneAssignment <- c(rep(1, genome$getGenomeSize()))
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, model= "RFP", split.serine = TRUE, mixture.definition = mixDef)
#parameter <- initializeParameterObject(model="RFP", restart.file="30restartFile.rst")
# initialize MCMC object
samples <- 40
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
# get model object
model <- initializeModelObject(parameter, "RFP")
setRestartSettings(mcmc, "restartFile.rst", 10, TRUE)
#run mcmc on genome with parameter using model
system.time(
runMCMC(mcmc, genome, model, 8)
)
trace <- parameter$getTraceObject()
writeParameterObject(parameter, file="RFPObject1.Rdat")
writeMCMCObject(mcmc, file="MCMCObject1.Rdat")
pdf("RFP_Genome_allUnique_startCSP_True_startPhi_true_adaptSphi_True.pdf")
plot(mcmc) #plots the whole logliklihood trace
#Here I take a subset of the trace values for the logliklihood trace and plot them.
#The primary reason for doing this is the "jump" that throws the scale of the graph
#at the beginning is removed by taking out the beginning values.
loglik.trace <- mcmc$getLogLikelihoodTrace()
start <- length(loglik.trace) * 0.5 #the multiplier determines how much of the beginning trace is
#eliminated.
logL <- logL <- mean(loglik.trace[start:length(loglik.trace)]) #get the mean for the subset
plot(loglik.trace[start:length(loglik.trace)], type="l", main=paste("logL:", logL), xlab="Sample", ylab="log(Likelihood)")
grid (NULL,NULL, lty = 6, col = "cornsilk2")
plot(trace, what = "MixtureProbability") #right now, will be straight line (mix =1)
plot(trace, what = "Mphi")
plot(trace, what = "Sphi")
plot(trace, what = "ExpectedPhi")
loglik.trace <- mcmc$getLogLikelihoodTrace()
acf(loglik.trace)
acf(loglik.trace[start:length(loglik.trace)])
dev.off()
pdf("RFP_CSP_Values_Mixture1.pdf", width = 11, height = 20)
#plot(trace, what = "Expression", geneIndex = 905) #used to make sure gene stabalized, not really needed now
plot(trace, what = "Alpha", mixture = 1)
plot(trace, what = "LambdaPrime", mixture = 1)
dev.off()
pdf("correlationBetweenAlphaAndLambdaPrime.pdf")
cat <- 1
proposal <- FALSE
alphaList <- numeric (61)
lambdaPrimeList <- numeric (61)
waitingTimes <- numeric(61)
alpha.ci <- matrix(0, ncol=2, nrow=61)
lambdaPrime.ci <- numeric(61)
phiList <- numeric(genome$getGenomeSize())
ids <- numeric(genome$getGenomeSize())
codonList <- codons()
for (i in 1:61)
{
codon <- codonList[i]
alphaList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alpha.ci[i,] <- quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
lambdaPrimeList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 1)
lambdaPrimeTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 1)
lambdaPrime.ci[i,] <- quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
waitingTimes[i] <- alphaList[i] * lambdaPrimeList[i]
}
cat <- 1
proposal <- FALSE
alphaList <- numeric (61)
lambdaPrimeList <- numeric (61)
waitingTimes <- numeric(61)
alpha.ci <- matrix(0, ncol=2, nrow=61)
lambdaPrime.ci <- numeric(61)
phiList <- numeric(genome$getGenomeSize())
ids <- numeric(genome$getGenomeSize())
codonList <- codons()
for (i in 1:61)
{
codon <- codonList[i]
alphaList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alpha.ci[i,] <- quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
lambdaPrimeList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 1)
lambdaPrimeTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 1)
lambdaPrime.ci[i,] <- quantile(lambdaPrimeTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
waitingTimes[i] <- alphaList[i] * lambdaPrimeList[i]
}
cat <- 1
proposal <- FALSE
alphaList <- numeric (61)
lambdaPrimeList <- numeric (61)
waitingTimes <- numeric(61)
alpha.ci <- matrix(0, ncol=2, nrow=61)
lambdaPrime.ci <- matrix(0, ncol=2, nrow=61)
phiList <- numeric(genome$getGenomeSize())
ids <- numeric(genome$getGenomeSize())
codonList <- codons()
for (i in 1:61)
{
codon <- codonList[i]
alphaList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 0)
alphaTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 0)
alpha.ci[i,] <- quantile(alphaTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
lambdaPrimeList[i] <- parameter$getCodonSpecificPosteriorMean(cat, samples * 0.5, codon, 1)
lambdaPrimeTrace <- trace$getCodonSpecificParameterTraceByMixtureElementForCodon(1, codon, 1)
lambdaPrime.ci[i,] <- quantile(lambdaPrimeTrace[(samples * 0.5):samples], probs = c(0.025,0.975))
waitingTimes[i] <- alphaList[i] * lambdaPrimeList[i]
}
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(alpha.ci),
main = "Confidence Intervals for Alpha Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
confidenceInterval.plot(x = 1:61, y = alphaList, sd.y = alpha.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
plot(NULL, NULL, xlim=range(1:61, na.rm = T), ylim=range(lambdaPrime.ci),
main = "Confidence Intervals for LambdaPrime Parameter", xlab = "Codons",
ylab = "Estimated values", axes=F)
confidenceInterval.plot(x = 1:61, y = lambdaPrimeList, sd.y = lambdaPrime.ci)
axis(2)
axis(1, tck = 0.02, labels = codonList[1:61], at=1:61, las=2, cex.axis=.6)
dev.off()
rm(list=ls())
library(ribModel)
genome <- initializeGenomeObject(file =
"../data/rfp/rfp.counts.by.codon.and.gene.GSE63789.wt.csv", FALSE)
sphi_init <- c(2)
numMixtures <- 1
mixDef <- "allUnique"
geneAssignment <- c(rep(1, genome$getGenomeSize()))
parameter <- initializeParameterObject(genome, sphi_init, numMixtures, geneAssignment, model= "RFP", split.serine = TRUE, mixture.definition = mixDef)
#parameter <- initializeParameterObject(model="RFP", restart.file="30restartFile.rst")
samples <- 40
thining <- 10
adaptiveWidth <- 10
mcmc <- initializeMCMCObject(samples=samples, thining=thining, adaptive.width=adaptiveWidth,
est.expression=TRUE, est.csp=TRUE, est.hyper=TRUE)
model <- initializeModelObject(parameter, "RFP")
setRestartSettings(mcmc, "restartFile.rst", 10, TRUE)
system.time(
runMCMC(mcmc, genome, model, 8)
)
